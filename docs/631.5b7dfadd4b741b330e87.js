"use strict";(self.webpackChunkenspect=self.webpackChunkenspect||[]).push([[631],{7631:(D,f,o)=>{o.r(f),o.d(f,{AggregatesModule:()=>L}),o(5493);var y=o(3061),g=o(776),c=o(8583),w=o(3256),p=o(5319),m=o(136);const b={label:{color:"#fff",position:"right",verticalAlign:"middle",align:"left"}},u={color:"rgb(1, 255, 255)",shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:10,opacity:1},C={backgroundColor:"#000",color:"#fff",position:"left",verticalAlign:"middle",align:"right"},S={color:"rgb(1, 255, 255)"},O={color:"#fff"},M={color:"#E77AE9"},F={color:"pink"};function A(r,s,t=m.Qq){return"Energiebilanz"===r?{textStyle:{fontFamily:"Oswald",fontSize:t.fontsize},scale:!0,scaleSize:20,series:[{type:"tree",width:t.width,id:0,name:"aggregates_tree",data:[s],top:"2%",left:t.left,right:t.right,bottom:"26%",symbolSize:32,edgeShape:"polyline",edgeForkPosition:"100%",initialTreeDepth:1,symbolKeepAspect:!0,lineStyle:{width:2},itemStyle:u,label:C,leaves:b,emphasis:{focus:"descendant"},expandAndCollapse:!0,animationDuration:750,animationDurationUpdate:1e3}]}:{textStyle:{fontFamily:"Oswald",fontSize:24},scale:!0,scaleSize:20,series:[{type:"tree",width:t.width,id:0,name:"aggregates_tree",data:[s],top:"0%",left:t.left,right:t.right,bottom:"26%",symbolSize:26,edgeShape:"polyline",edgeForkPosition:"100%",initialTreeDepth:1,symbolKeepAspect:!0,lineStyle:{width:2},itemStyle:u,label:C,leaves:b,emphasis:{focus:"descendant"},expandAndCollapse:!0,animationDuration:750,animationDurationUpdate:1e3}]}}var a=o(8720),T=o(9030),x=o(9598),h=o(8239);let k=(()=>{class r{constructor(t){this.dataState=t,this.subs=new p.w}ngOnInit(){}onNodeClick(t){var e=this;return(0,h.Z)(function*(){e.dataState.setAggregate([t.data.name])})()}onChartInit(t){this.chart=t,this.chart.resize({height:580})}}return r.\u0275fac=function(t){return new(t||r)(a.Y36(x.W))},r.\u0275cmp=a.Xpm({type:r,selectors:[["aggregates-treemap"]],inputs:{selectedBalance:"selectedBalance",data:"data",chartOptions:"chartOptions"},decls:2,vars:2,consts:[[1,"aggregates-treemap"],["echarts","",1,"chart",3,"options","merge","chartInit","chartClick"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.NdJ("chartInit",function(i){return e.onChartInit(i)})("chartClick",function(i){return e.onNodeClick(i)}),a.qZA(),a.qZA()),2&t&&(a.xp6(1),a.Q6J("options",e.chartOptions)("merge",e.mergeOptions))},directives:[g._w],styles:[".aggregates-treemap[_ngcontent-%COMP%]{position:relative;z-index:3;overflow:hidden;top:-10px}@media (max-width: 568px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:482px;width:452px;transform:scaleX(.92) scaleY(.4) translate(-5%,-68.5%)}}@media (min-width: 569px) and (max-width: 667px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:508px;transform:scaleX(.92) scaleY(.44) translate(-5%,-54.5%)}}@media (min-width: 668px) and (max-width: 736px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:588px;transform:scaleX(.92) scaleY(.44) translate(-5%,-54.5%)}}@media (min-width: 737px) and (max-width: 740px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:588px;transform:scaleX(.92) scaleY(.44) translate(-5%,-57.5%)}}@media (min-width: 741px) and (max-width: 812px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:648px;transform:scaleX(.92) scaleY(.48) translate(-5%,-49.5%)}}@media (min-width: 813px) and (max-width: 844px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:668px;transform:scaleX(.92) scaleY(.5) translate(-4.5%,-44.5%)}}@media (min-width: 845px) and (max-width: 848px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:668px;transform:scaleX(.92) scaleY(.52) translate(-4%,-40.5%)}}@media (min-width: 849px) and (max-width: 854px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:472px;width:500px;transform:scaleX(1.25) scaleY(.58) translate(9%,-29.5%)}}@media (min-width: 855px) and (max-width: 897px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:482px;width:700px;transform:scaleX(.94) scaleY(.52) translate(-4%,-40.5%)}}@media (min-width: 898px) and (max-width: 927px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:482px;width:700px;transform:scaleX(.96) scaleY(.54) translate(-2.7%,-37%)}}@media (min-width: 928px) and (max-width: 960px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:482px;width:900px;transform:scaleX(.9) scaleY(.58) translate(-11.45%,-28.5%)}}@media (min-width: 961px) and (max-width: 1024px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:482px;width:900px;transform:scaleX(.9) scaleY(.58) translate(-11.45%,-28.5%)}}@media (min-width: 1025px) and (max-width: 1281px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:470px;width:1124px;transform:scaleX(.94) scaleY(.75) translate(-11.45%,-12.5%)}}@media (min-width: 1282px) and (max-width: 1367px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{height:470px;width:1124px;transform:scaleX(.92) scaleY(.74) translate(65%,172.5%)}}@media (min-width: 1368px) and (max-width: 1600px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:470px;width:1120px;top:-10px;transform:scale(.78) translate(-14%,-12%)}}@media (min-width: 1601px) and (orientation: landscape){.aggregates-treemap[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:488px;width:1160px;top:-10px;transform:scale(1) translateY(2%)}}"]}),r})();var v=o(8629);let B=(()=>{class r{constructor(t){this.dataState=t,this.subs=new p.w,this.lastAncestors=[],this.notFetchableNodes=["Aggregate","Erzeugung","Umwandlung","Verbrauch","Sektoren","Sektoren Aggregiert","Sektor Energie"]}handleFirstLevelChanges(t,e,n){var i=this;return(0,h.Z)(function*(){"Gesamt"===e?(i.traverse([i.data],[e],"name",[i.setSelected()]),i.merge(n)):(i.traverse([i.data],t,"name",[i.collapse()]),i.merge(n),yield(0,v.Vs)(800),i.traverse([i.data],t,"name",[i.expand(),i.setSelected()]),i.merge(n))})()}handleLeaveChanges(t,e){this.traverse([this.data],[t],"name",[this.setSelected()]),this.isLeave(this.lastSelectedNode)&&this.traverse([this.data],[this.lastSelectedNode],"name",[this.collapse(),this.setUnselected()]),this.merge(e)}handleBranchChanges(t,e){var n=this;return(0,h.Z)(function*(){n.traverse([n.data],n.lastAncestors,"name",[n.setUnselected(),n.collapse()]),n.merge(e),yield(0,v.Vs)(800),n.traverse([n.data],t,"name",[n.setSelected(),n.expand()]),n.merge(e)})()}onNodeClick(t){var e=this;return(0,h.Z)(function*(){let n=t.data.name,i=e.getLastAncestorsFromEvent(t),l=function(r,s){let t=s.length,e=m.Qq;if("Energiebilanz"===r)switch(t){case 1:e.width=500,e.left="12%",e.fontsize=28;break;case 2:e.width=500,e.left="18%",e.fontsize=s.includes("Sektoren")?24:28;break;case 3:e.width=500,e.left="20%",e.fontsize=s.includes("Sektoren")?24:28;break;case 4:e.width=s.includes("Umwandlung")?900:500,e.left=s.includes("Umwandlung")?"-10%":"10%",e.fontsize=24;break;case 5:e.width=1100,e.left="-20%",e.fontsize=24;break;case 6:e.width=1200,e.left="-40%",e.fontsize=22;break;case 7:case 8:e.width=1500,e.left="-60%",e.fontsize=22}else switch(t){case 3:e=function(r,s){let t=[...r].pop(),e=Object.assign({},s);switch(t){case"Anteile":e.width=1e3,e.left="-35%",e.fontsize=20;break;case"Fernw\xe4rme Produktion erneuerbar (TJ)":e.width=1e3,e.left="-11.6%",e.fontsize=20;break;case"Energetischer Endverbrauch Erneuerbare (TJ)":e.width=1e3,e.left="-20.6%",e.fontsize=20;break;case"Elektrische Energie Produktion erneuerbar (TJ)":default:e.width=1e3,e.left="-26.6%",e.fontsize=20}return e}(s,e);break;case 4:e.width=s.includes("Endverbrauch")?1e3:1300,e.left=s.includes("Endverbrauch")?"-30%":"-50%",e.fontsize=24;break;case 5:e.width=1600,e.left="-80%",e.fontsize=24}return e}(e.selectedBalance,i);void 0===e.lastSelectedNode?yield e.handleFirstLevelChanges(i,n,l):e.isLeave(n)&&"Gesamt"!==n?e.handleLeaveChanges(n,l):e.handleBranchChanges(i,l),e.lastSelectedNode=n,e.lastAncestors=e.getLastAncestorsFromEvent(t);let d=e.getFetchableAggregateFrom(e.lastAncestors);e.upateDataState(d)})()}getFetchableAggregateFrom(t){return t.filter(e=>"Aggregate"!==e&&"aggregates_tree"!==e)}upateDataState(t){this.dataState.setAggregate(t)}isLeave(t){let e;return this.traverse([this.data],[t],"name",[n=>{e=void 0===n.children}]),e}getLastAncestorsFromEvent(t){let e=[];return t.treeAncestors.forEach(n=>{e.push(n.name)}),e}traverse(t,e,n,i,l=!0){if(Array.isArray(e)||(e=[e]),null!=t)for(var d=0;d<t.length;d++)e.includes(t[d][n])&&i.forEach(I=>{I(t[d])}),l&&t[d].children&&this.traverse(t[d].children,e,n,i)}merge(t){this.mergeOptions=A(this.selectedBalance,this.data,t)}collapse(){return t=>{t.collapsed=!0}}expand(){return t=>{t.collapsed=!1}}setSelected(){return t=>{let e={};e=this.notFetchableNodes.includes(t.name)?F:M,t.label=e,t.itemStyle=e}}setUnselected(){return t=>{t.label=O,t.itemStyle=S}}onChartInit(t){this.chart=t,this.chart.resize("Energiebilanz"===this.selectedBalance?{height:590,width:1164}:{height:652,width:"auto"})}}return r.\u0275fac=function(t){return new(t||r)(a.Y36(x.W))},r.\u0275cmp=a.Xpm({type:r,selectors:[["aggregates-tree"]],inputs:{selectedBalance:"selectedBalance",data:"data",chartOptions:"chartOptions"},decls:2,vars:2,consts:[[1,"aggregates-tree"],["echarts","",1,"chart",3,"options","merge","chartInit","chartClick"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.NdJ("chartInit",function(i){return e.onChartInit(i)})("chartClick",function(i){return e.onNodeClick(i)}),a.qZA(),a.qZA()),2&t&&(a.xp6(1),a.Q6J("options",e.chartOptions)("merge",e.mergeOptions))},directives:[g._w],styles:[".aggregates-tree[_ngcontent-%COMP%]{position:relative;z-index:2;overflow:hidden;top:-10px}@media (max-width: 568px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:450px;width:946px;transform:scale(.44) translate(-64.5%,-60%)}}@media (min-width: 569px) and (max-width: 667px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:464px;width:972px;transform:scale(.48) translate(-55%,-51%)}}@media (min-width: 668px) and (max-width: 736px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:456px;width:964px;transform:scale(.56) translate(-40%,-37%)}}@media (min-width: 737px) and (max-width: 740px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:456px;width:1134px;transform:scale(.48) translate(-55%,-50%)}}@media (min-width: 741px) and (max-width: 812px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:436px;width:1142px;transform:scale(.52) translate(-47%,-42%)}}@media (min-width: 813px) and (max-width: 844px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:446px;width:1148px;transform:scale(.54) translate(-43.5%,-40%)}}@media (min-width: 845px) and (max-width: 848px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:436px;width:1072px;transform:scale(.58) translate(-37%,-33%)}}@media (min-width: 849px) and (max-width: 854px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:490px;width:1042px;transform:scale(.6) translate(-34%,-31.5%)}}@media (min-width: 855px) and (max-width: 897px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:436px;width:1128px;transform:scale(.58) translate(-37%,-33%)}}@media (min-width: 898px) and (max-width: 927px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:452px;width:1168px;transform:scale(.58) translate(-37%,-33%)}}@media (min-width: 928px) and (max-width: 960px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:452px;width:1100px;transform:scale(.64) translate(-28.5%,-25%)}}@media (min-width: 961px) and (max-width: 1024px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:452px;width:1100px;transform:scale(.64) translate(-28.5%,-25%)}}@media (min-width: 1025px) and (max-width: 1281px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:470px;width:1124px;transform:scale(.78) translate(-14.5%,-12%)}}@media (min-width: 1282px) and (max-width: 1367px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:470px;width:1124px;transform:scale(.78) translate(75%,161%)}}@media (min-width: 1368px) and (max-width: 1600px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:470px;width:1120px;transform:scale(.78) translate(-14%,-12%)}}@media (min-width: 1601px) and (orientation: landscape){.aggregates-tree[_ngcontent-%COMP%]{border-width:2px;border-style:solid;border-color:transparent;height:488px;width:1160px;transform:scale(1) translateY(2%)}}"]}),r})();function _(r,s){if(1&r&&(a.TgZ(0,"div"),a._UZ(1,"aggregates-treemap",3),a.qZA()),2&r){const t=a.oxw();a.xp6(1),a.Q6J("selectedBalance",t.selectedBalance)("data",t.data)("chartOptions",t.chartOptions)}}function Y(r,s){if(1&r&&(a.TgZ(0,"div"),a._UZ(1,"aggregates-tree",3),a.qZA()),2&r){const t=a.oxw();a.xp6(1),a.Q6J("selectedBalance",t.selectedBalance)("data",t.data)("chartOptions",t.chartOptions)}}const Z=[{path:"",component:(()=>{class r{constructor(t,e){this.fetchService=t,this.dataState=e,this.subs=new p.w}ngOnInit(){this.setSubscriptionSelectedBalance(),this.subs.add(this.subscriptionSelectedBalance)}setSubscriptionSelectedBalance(){this.subscriptionSelectedBalance=this.dataState.selectedBalance$.subscribe(t=>{this.selectedBalance=t,console.log("~ this.selectedBalance",this.selectedBalance),this.fetchAndSetOptionData(t)})}fetchAndSetOptionData(t){let n=m.l_[t].concat("_aggregates");this.fetchService.queryBalanceIndex(n).subscribe(i=>{this.data=JSON.parse(i.balanceIndex[0].data),this.chartOptions="Nutzenergieanalyse"===this.selectedBalance?function(r,s={width:400,left:"22%",right:"0%",fontsize:28}){return{textStyle:{fontFamily:"Oswald",fontSize:20},roam:!1,series:[{leafDepth:2,selectedMode:"single",breadcrumb:{show:!1},type:"treemap",nodeClick:"link",visibleMin:300,top:"0%",label:{show:!0,formatter:"{b}",color:"#AAFEFE"},upperLabel:{show:!1,height:30},itemStyle:{borderColor:"#AAFEFE"},select:{label:{color:"black"},itemStyle:{borderColor:"#AAFEFE",color:"#AAFEFE"}},levels:[{itemStyle:{borderColor:"#AAFEFE",borderWidth:1,gapWidth:1},upperLabel:{show:!1}},{itemStyle:{borderColor:"#AAFEFE",borderWidth:0,gapWidth:0,color:"black"},label:{color:"#AAFEFE"},emphasis:{itemStyle:{borderColor:"#AAFEFE"}}},{colorSaturation:[.35,.5],itemStyle:{borderColor:"#AAFEFE",borderWidth:1,gapWidth:1,borderColorSaturation:.6}}],data:[r]}]}}(this.data):A(this.selectedBalance,this.data)})}onDestroy(){this.subs.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(a.Y36(T.l),a.Y36(x.W))},r.\u0275cmp=a.Xpm({type:r,selectors:[["app-aggregates"]],decls:4,vars:2,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"selectedBalance","data","chartOptions"]],template:function(t,e){1&t&&(a.TgZ(0,"div"),a.ynx(1,0),a.YNc(2,_,2,3,"div",1),a.YNc(3,Y,2,3,"div",2),a.BQk(),a.qZA()),2&t&&(a.xp6(1),a.Q6J("ngSwitch",e.selectedBalance),a.xp6(1),a.Q6J("ngSwitchCase","Nutzenergieanalyse"))},directives:[c.RF,c.n9,c.ED,k,B],encapsulation:2}),r})()}];let N=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=a.oAB({type:r}),r.\u0275inj=a.cJS({imports:[[w.Bz.forChild(Z)],w.Bz]}),r})(),L=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=a.oAB({type:r}),r.\u0275inj=a.cJS({imports:[[c.ez,N,g.Ns.forRoot({echarts:y})]]}),r})()}}]);